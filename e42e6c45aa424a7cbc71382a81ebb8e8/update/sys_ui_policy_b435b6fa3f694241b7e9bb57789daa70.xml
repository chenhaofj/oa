<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<record_update table="sys_ui_policy">
  <sys_ui_policy action="INSERT_OR_UPDATE">
    <active>true</active>
    <conditions>invoiceISNOTEMPTY^EQ</conditions>
    <description/>
    <global>true</global>
    <inherit>false</inherit>
    <isolate_script>false</isolate_script>
    <model_id/>
    <model_table/>
    <on_load>true</on_load>
    <order>90</order>
    <reverse_if_false>true</reverse_if_false>
    <run_scripts>true</run_scripts>
    <script_false>function onCondition() {}</script_false>
    <script_true>function onCondition() {
  var invoice = g_form.getValue('invoice');
  var csu = new GlideAjax("CostStandardUtils"); //构造器参数为脚本库名称
  csu.addParam("sysparm_name", "checkInvoice"); //调用的方法
  csu.addParam("invoice", invoice); //其他参数
  var done = function(res) {
    //    	const { cost } = res.data.result;
    if ('' === res.data.result) {
      alert("该发票已提交，请勿重复提交");
      g_form.setValue('invoice', '');
    }
  }
  csu.getJson(done.bind(this));
}</script_true>
    <set_values/>
    <short_description>发票唯一性校验</short_description>
    <sys_class_name>sys_ui_policy</sys_class_name>
    <sys_created_by>admin</sys_created_by>
    <sys_created_on>2022-05-31 15:47:20</sys_created_on>
    <sys_domain>global</sys_domain>
    <sys_domain_path>/</sys_domain_path>
    <sys_effective>true</sys_effective>
    <sys_id>b435b6fa3f694241b7e9bb57789daa70</sys_id>
    <sys_mod_count>1</sys_mod_count>
    <sys_name/>
    <sys_overrides/>
    <sys_package/>
    <sys_policy/>
    <sys_scope>e42e6c45aa424a7cbc71382a81ebb8e8</sys_scope>
    <sys_update_name/>
    <sys_updated_by>admin</sys_updated_by>
    <sys_updated_on>2022-05-31 15:47:20</sys_updated_on>
    <table>x_yunji_oa_t_cost</table>
    <ui_type>0</ui_type>
    <view/>
  </sys_ui_policy>
</record_update>
